<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/styles.C4lMXVjo.css" rel="stylesheet">
		<link href="../_app/immutable/assets/4.Wn9TjlgI.css" rel="stylesheet">
		<link href="../_app/immutable/assets/Header.pyFlinyt.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.DDx_HWi3.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/entry.1D32hnNW.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.CYfyUK1j.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.DpRiPcH4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.D6kgxu3v.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.BzGMCQVl.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.Cv570CYr.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/4.BKGCjSrB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Header.DRgHh2QQ.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">  <header class="svelte-ox29ql"><div class="pageTitle svelte-ox29ql"><a href="../" class="svelte-ox29ql" data-svelte-h="svelte-1ht7jlc">Ken Knight</a>/Blog</div> <nav><ul class="svelte-ox29ql"><li><a href="../me" class="nohighlight svelte-ox29ql">Me</a></li>  <span class="nohighlight svelte-ox29ql">|</span><li><a href="../projects" class="nohighlight svelte-ox29ql">Projects</a></li>  <span class="highlight svelte-ox29ql">|</span><li><a href="../blog" class="highlight svelte-ox29ql">Blog</a></li>  <span class="highlight svelte-ox29ql">|</span><li><a href="../contact" class="nohighlight svelte-ox29ql">Contact</a></li>  <span class="nohighlight svelte-ox29ql">|</span><li><a href="../fashion" class="nohighlight svelte-ox29ql">Fashion</a></li> </ul></nav> </header> <div class="content svelte-6szpbu"><div class="post-header"><h1 class="svelte-6szpbu">Let's Build a Mini Chess Bot!</h1> <time datetime="2024-12-14" class="svelte-6szpbu">14 December 2024</time></div> <h2 data-svelte-h="svelte-1vo04f4">Intro</h2> <p data-svelte-h="svelte-1sk16yo">Back in late 2023, I and a friend took part in <a href="https://github.com/SebLague/Chess-Challenge" rel="nofollow" target="_blank">Sebastian Lague’s Chess Coding Challenge</a>, a competition where chess bots whose code was under 1024 tokens would duke it out for the 2 best rewards known to man, bragging rights and having your name possibly mentioned by a somewhat large internet celebrity.<br>
Programming with such constraints and a focus a focus on performance means that the code will be <strong>evil</strong>, we are sacrificing readability and extensibility for the sake of making the code shorter and faster, which for most real world applications is a terrible idea. Making code shorter for the sake of shortness is just pointless and computers are so fast that making very performant code usually isn’t particularly important.<br>
This was my first foray into C#, working collaboratively on code, and chess bots, so the following is by no means perfect, but should give you a good sense of where to start with your own chess bot and the big mistakes I made.<br> <a href="https://github.com/KennethOnGitHub/KnightToE4F" rel="nofollow" target="_blank">[View our bot here]</a></p> <h2 data-svelte-h="svelte-a8bhms">The Bot</h2> <p data-svelte-h="svelte-1282gze">A chess bot has two key components, an <strong>evaluation algorithm</strong> and a <strong>search algorithm</strong>. An evaluation algorithm calculates how good a position is, a search algorithm looks ahead into the future to find those good positions. <br>
Chess is a game where the number of possible positions grows incredibly fast the further into the future you look (see <a href="https://en.wikipedia.org/wiki/Shannon_number" rel="nofollow" target="_blank">Shannon’s Number</a>), therefore, a strong search algorithm is pivotal to making a strong bot. Focusing far too much on evaluation compared to searching was one major mistake we made; looking further into the future trumps evaluating a position more precisely. It doesn’t matter if a position looks really good if looking ahead one move shows that it’ll be terrible (and vice-versa)!</p> <h3 data-svelte-h="svelte-1xxpqpg">Evaluating a position</h3> <p data-svelte-h="svelte-1ji07yc">When looking at a chess position, there are two things we looked at, <strong>material advantage</strong> (how much more value in terms of pieces one side has) and <strong>positional advantage</strong> (how much better these pieces are placed).</p> <h4 data-svelte-h="svelte-127rmxy">Material Advantage</h4> <p>Finding material advantage can be done incredibly simply by adding the total value of the pieces one side has and subtracting the value of the other side to get a numeric value. For example, if white has a queen and a rook whilst black has a queen and a knight, the material advantage for white would be: <span class="math math-inline"><!-- HTML_TAG_START --><span class="katex"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext>QUEEN VALUE</mtext><mo>+</mo><mtext>ROOK VALUE</mtext><mo>−</mo><mtext>QUEEN VALUE</mtext><mo>−</mo><mtext>KNIGHT VALUE</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\text{QUEEN VALUE} + \text{ROOK VALUE} - \text{QUEEN VALUE} - \text{KNIGHT VALUE})</annotation></semantics></math></span><!-- HTML_TAG_END --></span><br>
In the real world, the value of a type of piece isn’t static and changes as the game develops (e.g. a cluttered board benefits a knight, whilst an open board benefits a bishop), however, for the sake of simplicity manually setting static values for pieces is sufficient. For our bot, we used the following values:</p> <table data-svelte-h="svelte-qqkho8"><thead><tr><th align="center">Pawn</th> <th align="center">Knight</th> <th align="center">Bishop</th> <th align="center">Rook</th> <th align="center">Queen</th></tr></thead> <tbody><tr><td align="center">100</td> <td align="center">100</td> <td align="center">300</td> <td align="center">500</td> <td align="center">900</td></tr></tbody></table> <h4 data-svelte-h="svelte-1qwzr3x">Positional Advantage</h4> <p data-svelte-h="svelte-16qhlyn">Calculating the how well pieces are placed is a greater challenge, there are innumerable factors to consider (how central a piece is, whether or not it is blocked in by other pieces, whether the structure of the pawns is good, etc…) which I implore those who are interested in Chess Programming to look into, however, we have found that using a piece-square table yields excellent results for the amount of code required and is far more than sufficient on its own. A piece-square table, simply put, is an array of integers where each value in the array corresponds to the value of having a particular piece on that square (See one table we got from <a href="https://www.chessprogramming.org/PeSTO%27s_Evaluation_Function" rel="nofollow" target="_blank">PeSTO</a> that we used for our project below)</p> <pre class="language-csharp"><!-- HTML_TAG_START --><code class="language-csharp"><span class="token keyword">int</span> midgame_queen_table<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">,</span>   <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">29</span><span class="token punctuation">,</span>  <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">59</span><span class="token punctuation">,</span>  <span class="token number">44</span><span class="token punctuation">,</span>  <span class="token number">43</span><span class="token punctuation">,</span>  <span class="token number">45</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">39</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span>   <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span>  <span class="token number">57</span><span class="token punctuation">,</span>  <span class="token number">28</span><span class="token punctuation">,</span>  <span class="token number">54</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">17</span><span class="token punctuation">,</span>   <span class="token number">7</span><span class="token punctuation">,</span>   <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">29</span><span class="token punctuation">,</span>  <span class="token number">56</span><span class="token punctuation">,</span>  <span class="token number">47</span><span class="token punctuation">,</span>  <span class="token number">57</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">16</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">17</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>   <span class="token number">1</span><span class="token punctuation">,</span>
     <span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">26</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span>   <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">,</span>   <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span>   <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">14</span><span class="token punctuation">,</span>   <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token operator">-</span><span class="token number">35</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">11</span><span class="token punctuation">,</span>   <span class="token number">2</span><span class="token punctuation">,</span>   <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">15</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span>   <span class="token number">1</span><span class="token punctuation">,</span>
     <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">18</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-14z1b9m">As you can see here, in the midgame, placing a queen in the top left of the board would result in a -28 change in positional advantage. (Note that in our implementation of piece square tables, you’ll notice that we’ve flipped the table upside down as our square 0 is the bottom left square instead of being the top right square in the example given above). <br>
PeSTO was an integral part to making the evaluation function of multiple high performing bots on account of how surprisingly effective it is for the amount of code necessary for the implementation.</p> </div> 
			
			<script>
				{
					__sveltekit_146wcxi = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../_app/immutable/entry/start.DDx_HWi3.js"),
						import("../_app/immutable/entry/app.DpRiPcH4.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 4],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
